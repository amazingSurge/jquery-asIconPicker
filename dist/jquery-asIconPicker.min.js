/*! asIconPicker - v0.1.0 - 2014-05-09
* https://github.com/amazingsurge/jquery-asIconPicker
* Copyright (c) 2014 amazingSurge; Licensed MIT */
(function(s,e,i,t){"use strict";var a="asIconPicker",n={namespace:"asIconPicker",source:!1,tooltip:!0,hasSearch:!0,extraClass:"fa",iconPrefix:"fa-",emptyText:"None Selected",cancelSelected:!0,iconPicker:function(){return'<div class="namespace-selector"><span class="namespace-selected-icon">None selected</span><span class="namespace-selector-arrow"><i></i></span></div><div class="namespace-selector-popup"><div class="namespace-icons-container"></div></div>'},iconSearch:function(){return'<div class="namespace-selector-search"><input type="text" name="" value="" placeholder="Search" class="namespace-search-input"/><i class="asIcon-search"></i></div>'},onInit:null,onReady:null,onAfterFill:null},c=s[a]=function(e,i){this.element=e,this.$element=s(e),this.options=s.extend({},n,i,this.$element.data()),this._plugin=a,this.namespace=this.options.namespace,this.classes={disabled:this.namespace+"_disabled",wrapper:this.namespace+"-wrapper",search:this.namespace+"_with_search",active:this.namespace+"_active",hide:this.namespace+"_hide",hover:this.namespace+"_hover",mask:this.namespace+"-mask"},this.$element.addClass(this.namespace),this.$element.wrap('<div class="'+this.classes.wrapper+'"></div>'),this.$wrapper=this.$element.parent();var t=this.options.iconPicker().replace(/namespace/g,this.namespace),c=this.options.iconSearch().replace(/namespace/g,this.namespace);this.$iconPicker=s(t),this.$iconContainer=this.$iconPicker.find("."+this.namespace+"-icons-container"),this.options.hasSearch&&(this.$iconContainer.before(s(c)),this.$iconContainer.parent().addClass(this.classes.search),this.$searchIcon=this.$iconPicker.find("."+this.namespace+"-selector-search i"),this.iconsSearched=[],this.isSearch=!1),this.disabled=!1,this.initialized=!1,this._trigger("init"),this.init()};c.prototype={constructor:c,init:function(){var e=this;this.$element.hide(),this.$element.before(this.$iconPicker),!this.options.source&&this.$element.is("select")&&(this.options.source=[],this.$element.children().each(s.proxy(function(i,t){var a=[];if("optgroup"===t.tagName.toLowerCase()){for(var n=s.extend({},s(t).data(),{label:t.label,options:[]}),c=0;s(t).children().length>c;c++)a=[],a.value=s(t).children().eq(c).val(),a.text=s(t).children().eq(c).text(),n.options.push(a);e.options.source.push(n)}else s(t).val()&&(a.value=s(t).val(),a.text=s(t).text(),this.options.source.push(a))},this))),this.showLoading(),this.$wrapper.find("."+this.namespace+"-selector-popup").addClass(this.namespace+"_hide"),this.$wrapper.find("."+this.namespace+"-selector").on("click",function(){s(this).addClass(e.classes.active),s(this).siblings("."+e.namespace+"-selector-popup").addClass(e.classes.active).removeClass(e.classes.hide),e.reset(),s(this).hasClass(e.classes.active)&&(e.$iconPicker.find("."+e.namespace+"-search-input").focus().select(),e.$mask=s("<div></div>").addClass(e.classes.mask).appendTo(e.$element.parent()),e.$mask.on("click",function(){e._clearMask(),e.$wrapper.find("."+e.namespace+"-selector").removeClass(e.classes.active),e.$wrapper.find("."+e.namespace+"-selector-popup").addClass(e.classes.hide).removeClass(e.classes.active)}))}),this.$iconPicker.find("."+this.namespace+"-search-input").keyup(s.proxy(function(e){var i=s(e.currentTarget).val(),a="";if(""===i)return this.reset(),t;this.$searchIcon.removeClass("asIcon-search"),this.$searchIcon.addClass("asIcon-times"),this.isSearch=!0,this.iconsSearched=[];for(var n,c=0;n=this.options.source[c];c++)if(n.label!==t){var o=[];o.label=n.label,o.options=s.grep(n.options,function(s){return(s.value||s).search(i.toLowerCase())>=0}),o.options.length>0&&(this.iconsSearched.push(o),a=this.iconsSearched[0].options[0].value||this.iconsSearched[0].options[0])}else n.value.search(i.toLowerCase())>=0?this.iconsSearched.push(n):0,this.iconsSearched.length>0&&(a=this.iconsSearched[0].value);this.fillIcon(),this.iconsSearched.length>0&&(this.current=a,this.select())},this)),this.$iconPicker.find("."+this.namespace+"-selector-search").on("click",".asIcon-times",s.proxy(function(){this.$iconPicker.find("."+this.namespace+"-search-input").focus().select(),this.reset()},this)),this.$iconContainer.on("click","."+this.namespace+"-list li",s.proxy(function(e){return this.options.cancelSelected&&s(e.currentTarget).hasClass(this.namespace+"-current")?(s(e.currentTarget).removeClass(this.namespace+"-current"),this.set(),t):(this.set(s(e.currentTarget).data("class")),this._clearMask(),this.$wrapper.find("."+this.namespace+"-selector").removeClass(this.classes.active),this.$wrapper.find("."+this.namespace+"-selector-popup").addClass(this.classes.hide).removeClass(this.classes.active),t)},this)).on("mouseenter","."+this.namespace+"-list li",s.proxy(function(e){this.highlight(s(e.currentTarget).data("class"))},this)).on("mouseleave","."+this.namespace+"-list li",s.proxy(function(){this.highlight()},this)),this.$iconPicker.click(function(s){return s.stopPropagation(),!1}),this.initialized=!0,this._trigger("ready")},showLoading:function(){this.$iconContainer.html('<i class="'+this.namespace+'loading"></i>'),this.options.source instanceof Array&&this.fillIcon()},fillIcon:function(){this.$iconContainer.data("scroll")!==t&&this.$iconContainer.scrollable("destory");var e=[],i=[];if(e=this.isSearch?this.iconsSearched:this.options.source,1>e.length)return this.$iconContainer.html('<span class="'+this.namespace+'-error"><i class="'+this.options.extraClass+" "+this.options.iconPrefix+'ban"></i></span>'),t;this.$iconContainer.html("");for(var a,n=0;a=e[n];n++)if(a.label!==t){if(a.options.length)var c=s('<div class="'+this.namespace+'-group"><div class="'+this.namespace+'-group-label">'+a.label+':</div><ul class="'+this.namespace+'-list"></ul></div>').appendTo(this.$iconContainer);for(var o,r=0;o=a.options[r];r++)s("<li/>",{html:'<i class="'+this.options.extraClass+" "+(o.value||o)+'"></i>',title:this.options.tooltip?o.text||o:""}).data("class",o.value||o).appendTo(c.find("ul")),i.push(o)}else{var h=this.$iconContainer.children().last().attr("class");h!==this.namespace+"-list"&&s('<ul class="'+this.namespace+'-list"></ul>').appendTo(this.$iconContainer),s("<li/>",{html:'<i class="'+this.options.extraClass+" "+(a.value||a)+'"></i>',title:this.options.tooltip?a.text||a:""}).data("class",a.value||a).appendTo(this.$iconContainer.children().last()),i.push(a)}this.options.tooltip&&(s.asTooltip.closeAll(),this.$iconContainer.find("."+this.namespace+"-list li").asTooltip({namespace:"asTooltip",skin:"skin-dream",onlyOne:!0})),-1===s.inArray(this.$element.val(),i)?this.set():this.set(this.$element.val()),this.$iconContainer.scrollable(),this._trigger("afterFill")},highlight:function(s){s?this.$iconPicker.find("."+s).parent().addClass(this.classes.hover):this.$iconPicker.find("."+this.classes.hover).removeClass(this.classes.hover)},select:function(){this.$iconContainer.find("."+this.namespace+"-current").removeClass(this.namespace+"-current"),this.current&&this.$iconContainer.find("."+this.current).parent("li").addClass(this.namespace+"-current")},set:function(s){s?this.$iconPicker.find("."+this.namespace+"-selected-icon").removeClass(this.namespace+"-none-selected").html('<i class="'+this.options.extraClass+" "+s+'"></i>'+s):this.$iconPicker.find("."+this.namespace+"-selected-icon").addClass(this.namespace+"-none-selected").html('<i class="'+this.options.extraClass+" "+this.options.iconPrefix+"ban"+'"></i>'+this.options.emptyText),this.$element.val(s).triggerHandler("change"),this.current=s,this.select()},reset:function(){this.$iconPicker.find("."+this.namespace+"-search-input").val(""),this.$searchIcon.removeClass("asIcon-times"),this.$searchIcon.addClass("asIcon-search"),this.isSearch=!1,this.fillIcon(),this.$iconContainer.outerHeight()>=290&&this.$iconContainer.scrollable()},_clearMask:function(){this.$mask&&(this.$mask.off(".asIconPicker"),this.$mask.remove(),this.$mask=null)},_trigger:function(s){this.$element.trigger(a+"::"+s,this),s=s.replace(/\b\w+\b/g,function(s){return s.substring(0,1).toUpperCase()+s.substring(1)});var e="on"+s,i=arguments.length>1?Array.prototype.slice.call(arguments,1):t;"function"==typeof this.options[e]&&this.options[e].apply(this,i)},enable:function(){this.disabled=!1,this.$wrapper.removeClass(this.classes.disabled)},disable:function(){this.disabled=!0,this.$wrapper.addClass(this.classes.disabled)},destory:function(){this.$element.data(a,null),this._trigger("destory")}},c.defaults=n,s.fn[a]=function(e){if("string"!=typeof e)return this.each(function(){s.data(this,a)||s.data(this,a,new c(this,e))});var i=e,n=arguments.length>1?Array.prototype.slice.call(arguments,1):t;if(/^\_/.test(i))return!1;if(!(/^(getTabs)$/.test(i)||"val"===i&&n===t))return this.each(function(){var e=s.data(this,a);e&&"function"==typeof e[i]&&e[i].apply(e,n)});var o=this.first().data(a);return o&&"function"==typeof o[i]?o[i].apply(o,n):t}})(jQuery,document,window);